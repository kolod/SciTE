<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=windows-1251">
<meta name="generator" content="SciTE">

<title>Shell</title>
<style type="text/css">
body, td {FONT:x-small Verdana;}
table    {border:1px solid #1F1F1F; border-collapse:collapse;}
td,th    {border:1px solid #1F1F1F; padding:1px 5px 1px 5px;}
th       {background:#CCEEFF; color:#000080; font-size:x-small; text-align:left;}

a       {text-decoration:none;}
a:hover {background-color:#DDDDDD;}
a.tmenu {white-space:nowrap;}

h3 {
	color:#333399;
	border: 2px solid #FFCC00;
	background-color: #FFF7EE;
	padding: 2px 5px;
}

i     {font-weight:normal;}
em    {background-color:#F0FFF0;}
pre   {font-size:x-small; background-color:#F0FFFF;}
dfn   {color:#990099; font-weight:bold;}
var   {color:#333399; font-weight:bold; white-space:nowrap;}
code  {font-size:x-small; color:#333399; white-space:nowrap;}
cite  {color:#333399; font:menu;}

.cursor      {color:red;}
.windowsonly {background: #EBF3FF;}
.gtkonly     {background: #FFFFE7;}
.ruboardonly {background: #FFECFF;}

div.example {
	background: #F7FCF7;
	border: 1px solid #C0D7C0;
	margin: 0.3em 3em;
	padding: 0.3em 0.6em;
	font-family:Courier New;
	color:#333399;
}

span.example {
	background: #F7FCF7;
	font-family:Courier New;
	color:#333399;
}

table.tmenu {
	border-width:0;
}

.tmenu td {
	border-width:0;
	text-align:center;
	font-size:xx-small;
	font-weight:bold;
	color:white;
}

.tmenu a {color:#333399; white-space:nowrap;}
.tmenu a:hover {background-color:#F0F0F0;}

.head {font-size:110%; background-color:#D0E8E8;}
.author {text-align:right; font-size:80%}
sup {color:red;font-family:MS Sans Serif; font-weight:bold;}
</style>
</head>

<body bgcolor="white">
<table class="tmenu" width="100%"><tr><td>
<table bgcolor="#000000" width="100%" cellspacing="4" cellpadding="0" border="0" summary="banner">
	<tr>
		<td><img src="../../doc/SciTEIco.png" height="64" width="64" alt="Scintilla icon"></td>
		<td width="100%"><font size="5">Shell - Lua библиотека для SciTE</font></td>
	</tr>
</table>

<table bgcolor="#CCCCCC" width="100%" cellspacing="0" cellpadding="6" summary="tmenu">
	<tr><td>
		<a href="../../doc/SciTEDoc_rus.html">Документация</a>&nbsp;&nbsp;
		<a href="../../doc/SciTEFAQ_rus.html">FAQ</a>&nbsp;&nbsp;
		<a href="../../doc/SciTERegEx_rus.html">Регулярные выражения</a>&nbsp;&nbsp;
		<a href="../../doc/SciTELua_rus.html">LUA</a>&nbsp;&nbsp;
		<a href="../../doc/SciTEDirector_rus.html">SciTE Director</a>&nbsp;&nbsp;
		<a href="../../doc/CommandValuesExt_rus.html">Команды SciTE и Scintilla</a>&nbsp;&nbsp;
		<a href="../../doc/SciTE-Ru_Pack_rus.html">Сборка Ru-Board</a>&nbsp;&nbsp;
		<a href="../../doc/SciTE-Ru_Kernel_rus.html">Ядро SciTE-Ru</a>&nbsp;&nbsp;
		<nobr>Shell</nobr>&nbsp;&nbsp;
		<a href="../Helper/SciTE.Helper_rus.html">SciTE Helper</a>&nbsp;&nbsp;
		<a href="../../doc/ScintillaHistory_rus.html">История</a>
	</td></tr>
</table>
</td></tr></table>

<h3>Описание</h3>

<p>Внешняя Lua библиотека, расширяющяя возможности встроенного lua обработчика SciTE.</p>

<h3>Подключение</h3>

<p>Для использования функций бибилиотеки ее необходимо подключить и произвести инициализацию объекта <code>shell</code>:
<div class="example">
package.cpath = props["SciteDefaultHome"].."\\tools\\LuaLib\\?.dll;"..package.cpath<br>
-- покажем все пути, по которым SciTE будет искать нашу библиотеку<br>
print(package.cpath)<br>
-- загрузка библиотеки<br>
require 'shell'<br>
-- тест успешной загрузки<br>
if shell then<br>
&nbsp;&nbsp;print("Load shell.dll")<br>
end
</div></p>

<h3>Функции</h3>

<table width="100%" cellpadding="1" cellspacing="0" border="1">

<tr><td>
	<p class="head"> <sup>update</sup>
		<dfn>run (strCommand, [intWindowStyle], [bWaitOnReturn])</dfn>
	</p>
	<p>
	<p>
	<b>Описание:</b><br>
		&nbsp;&nbsp;Запуск внешнего приложения.<br>
	<br>
	<b>Параметры:</b><br>
		&nbsp;&nbsp;<dfn>strCommand</dfn> - командная строка запуска<br>
		&nbsp;&nbsp;<dfn>intWindowStyle</dfn> - стиль окна. Допустимые значения приведены в таблице:<br>
		<table style="margin-left:8pt;margin-top:3pt">
			<tr><th>Значение</th><th>Описание</th></tr>
			<tr><td align="center">0</td><td>Окно скрыто, и фокус передается скрытому окну</td></tr>
			<tr><td align="center">1</td><td>Окно имеет фокус и восстанавливает свои стандартные размер и положение (значение по умолчанию)</td></tr>
			<tr><td align="center">2</td><td>Окно отображается в виде значка с фокусом</td></tr>
			<tr><td align="center">3</td><td>Окно развертывается на полный экран с фокусом</td></tr>
			<tr><td align="center">4</td><td>Восстанавливаются предыдущие размер и положение окна. Активным остается текущее окно</td></tr>
			<tr><td align="center">6</td><td>Окно отображается в виде значка. Активным остается текущее окно</td></tr>
		</table><br>
		&nbsp;&nbsp;<dfn>bWaitOnReturn</dfn> = <var>true</var> | <var>false</var> (значение по умолчанию) - приостанавливать или нет скрипт на время выполнения команды</p>
		<br>
		<p>
	<b>Возвращаемое значение:</b><br>
		&nbsp;&nbsp;первое содержит код завершения вызываемого приложения,<br>
		&nbsp;&nbsp;второе - текст, который приложение вывело в <code>StdOut</code> или <code>StdErr</code> (работает только при <code>intWindowStyle = 0</code> и <code>bWaitOnReturn = true</code>)<br>
	</p>
		<p><b>Пример использования:</b>
		<div class="example">
		local err, output = shell.run('cmd /c DIR /b', 0, true)<br>
		if err == 0 then<br>
		&nbsp;&nbsp;print(output)<br>
		end
		</div>
		</p>
	<p class="author">Авторы: mimir, Дмитрий Маслов</p>
</td></tr>

<tr><td>
	<p class="head">
		<dfn>msgbox (strMessageText, [strTitle], [intOptions])</dfn>
	</p>
	<p>
		<b>Описание:</b><br>
		&nbsp;&nbsp;Вывод текстового сообщения с кнопками.<br>
	<br>
	<b>Параметры:</b><br>
		&nbsp;&nbsp;<dfn>strMessageText</dfn> - текст сообщения<br>
		&nbsp;&nbsp;<dfn>strTitle</dfn> - текст заголовка сообщения<br>
		&nbsp;&nbsp;<dfn>intOptions</dfn> - числовое выражение, представляющее собой сумму значений, перечисленных в таблице.
		<table style="margin-left:8pt;margin-top:3pt">
		<tr><th>Значение</th><th>Описание</th></tr>
		<tr>
		<td align="center">0</td>
		<td>Выводится кнопка ОК (значение по умолчанию)</td>
		</tr>
		<tr>
		<td align="center">1</td>
		<td>Выводятся кнопки ОК и Отмена (Cancel)</td>
		</tr>
		<tr>
		<td align="center">2</td>
		<td>Выводятся кнопки Стоп (Abort), Повтор (Retry) и Пропустить (Ignore)</td>
		</tr>
		<tr>
		<td align="center">3</td>
		<td>Выводятся кнопки Да (Yes), Нет (No) и Отмена (Cancel)</td>
		</tr>
		<tr>
		<td align="center">4</td>
		<td>Выводятся кнопки Да (Yes) и Нет (No)</td>
		</tr>
		<tr>
		<td align="center">5</td>
		<td>Выводятся кнопки Повтор (Retry) и Отмена (Cancel)</td>
		</tr>
		<tr>
		<td align="center">16</td>
		<td>Выводится значок Stop Mark</td>
		</tr>
		<tr>
		<td align="center">32</td>
		<td>Выводится значок Question Mark</td>
		</tr>
		<tr>
		<td align="center">48</td>
		<td>Выводится значок Exclamation Mark</td>
		</tr>
		<tr>
		<td align="center">64</td>
		<td>Выводится значок Information Mark</td>
		</tr>
		<tr>
		<td align="center">0</td>
		<td>По умолчанию в окне выбирается первая кнопка (значение по умолчанию)</td>
		</tr>
		<tr>
		<td align="center">256</td>
		<td>По умолчанию в окне выбирается вторая кнопка</td>
		</tr>
		<tr>
		<td align="center">512</td>
		<td>По умолчанию в окне выбирается третья кнопка</td>
		</tr>
		<tr>
		<td align="center">768</td>
		<td>По умолчанию в окне выбирается четвёртая кнопка</td>
		</tr>
		<tr>
		<td align="center">0</td>
		<td>Диалоговое окно выводится в модальном режиме (значение по умолчанию)</td>
		</tr>
		<tr>
		<td align="center">4096</td>
		<td>Диалоговое окно выводится в модальном режиме и располагается сверху всех запускаемых
		приложений</td>
		</tr>
		</table>
	</p>
	<br>
	<p>
	<b>Возвращаемое значение:</b><br>
		&nbsp;&nbsp;Возвращает код нажатой кнопки. Значения перечисленны в таблице:
		<table style="margin-left:8pt;margin-top:3pt">
		<tr><th>Значение</th><th>Описание</th></tr>
		<tr>
		<td align="center">1</td>
		<td>Нажата кнопка ОК</td>
		</tr>
		<tr>
		<td align="center">2</td>
		<td>Нажата кнопка Отмена (Cancel)</td>
		</tr>
		<tr>
		<td align="center">3</td>
		<td>Нажата кнопка Стоп (Abort)</td>
		</tr>
		<tr>
		<td align="center">4</td>
		<td>Нажата кнопка Повтор (Retry)</td>
		</tr>
		<tr>
		<td align="center">5</td>
		<td>Нажата кнопка Пропустить (Ignore)</td>
		</tr>
		<tr>
		<td align="center">6</td>
		<td>Нажата кнопка Да (Yes)</td>
		</tr>
		<tr>
		<td align="center">7</td>
		<td>Нажата кнопка Нет (No)</td>
		</tr>
		</table>
	</p>
		<p><b>Пример использования:</b>
		<div class="example">
		if shell.msgbox("Вы уверены?", "SciTE", 65) == 1 then<br>
		&nbsp;&nbsp;print("Yes")<br>
		end<br>
		</div>
		</p>
	<p class="author">Авторы: Midas, mimir</p>
</td></tr>

<tr><td>
	<p class="head">
		<dfn>getfileattr (strFileName)</dfn>
	</p>
	<p>
	<b>Описание:</b><br>
		&nbsp;&nbsp;Получение атрибутов файла.<br>
	<br>
	<b>Параметры:</b><br>
		&nbsp;&nbsp;<dfn>strFileName</dfn> - имя файла<br>
		<br>
	<b>Возвращаемое значение:</b><br>
		&nbsp;&nbsp;первое содержит атрибуты файла в виде числа,<br>
		&nbsp;&nbsp;второе содержит либо <var>nil</var> (при удачном завершении) либо текст сообщения об ошибке (при неудаче)
	</p>
		<p><b>Пример использования:</b>
		<div class="example">
		local attr, err = shell.getfileattr("c:\\MSDOS.SYS")<br>
		if err == nil then<br>
		&nbsp;&nbsp;print(attr)<br>
		else<br>
		&nbsp;&nbsp;print(err)<br>
		end
		</div>
		</p>
	<p class="author">Авторы: Midas</p>
</td></tr>

<tr><td>
	<p class="head">
		<dfn>setfileattr (strFileName, intFileAttr)</dfn>
	</p>
	<p>
	<b>Описание:</b><br>
		&nbsp;&nbsp;Установка атрибутов файла.<br>
	<br>
	<b>Параметры:</b><br>
		&nbsp;&nbsp;<dfn>strFileName</dfn> - имя файла<br>
		&nbsp;&nbsp;<dfn>iFileAttr</dfn> - атрибуты файла в числовом виде<br>
		<br>
	<b>Возвращаемое значение:</b><br>
		&nbsp;&nbsp;первое содержит либо <var>1</var> (при удачном завершении) либо <var>nil</var> (при неудаче),<br>
		&nbsp;&nbsp;второе содержит либо <var>nil</var> (при удачном завершении) либо текст сообщения об ошибке (при неудаче)
	</p>
		<p><b>Пример использования:</b>
		<div class="example">
		local result, err = shell.setfileattr("c:\\MSDOS.SYS", 32)<br>
		if result == 1 then<br>
		&nbsp;&nbsp;print("Атрибуты установлены успешно")<br>
		else<br>
		&nbsp;&nbsp;print(err)<br>
		end
		</div>
		</p>
	<p class="author">Авторы: Midas</p>
</td></tr>

<tr><td>
	<p class="head">
		<dfn>exec (strFileName, [strParameters], [boolNoShow], [strOperation])</dfn>
	</p>
	<p>
	<b>Описание:</b><br>
		&nbsp;&nbsp;Запуск файла зарегестрированным приложением. В отличии от run позволяет запускать файлы, документы и ссылки, а так же открывать каталоги.<br>
	<br>
	<b>Параметры:</b><br>
		&nbsp;&nbsp;<dfn>strFileName</dfn> - имя файла или папки<br>
		&nbsp;&nbsp;<dfn>strParameters</dfn> - строка параметров передаваемая загружаемому приложению или запуск без параметров (по умолчанию)<br>
		&nbsp;&nbsp;<dfn>boolNoShow</dfn> - если <var>true</var>, то запускается в скрытом режиме, <var>false</var> - показать окно (по умолчанию) <br>
		&nbsp;&nbsp;<dfn>strOperation</dfn> - исполняемая операция из перечисленных в таблице:<br>
		<table style="margin-left:8pt;margin-top:3pt">
		<tr><th>Значение</th><th>Описание</th></tr>
		<tr>
		<td align="center">open</td>
		<td>Открыть. strFileName может быть документом, приложением или папкой (параметр по умолчанию)</td>
		</tr>
		<tr>
		<td align="center">edit</td>
		<td>Изменить. Открывает файл на редактирование. strFileName должен быть документом.</td>
		</tr>
		<tr>
		<td align="center">print</td>
		<td>Печать. strFileName должен быть документом.</td>
		</tr>
		<tr>
		<td align="center">explore</td>
		<td>Открывает папку в проводнике Windows. strFileName должен указывать путь к папке</td>
		</tr>
		<tr>
		<td align="center">find</td>
		<td>Выводит диалоговое окно для поиска файлов по условиям, strFileName должен указывать путь к папке,<br>начиная с которой будет выполняться поиск</td>
		</tr>
		</table>
		<br>
	<b>Возвращаемое значение:</b><br>
		&nbsp;&nbsp;Возвращает <var>true</var> (при удачном запуске) или <var>false</var> (при неудаче)<br>
	</p>
		<p><b>Пример использования:</b>
		<div class="example">
		-- запустить приложение<br>
		shell.exec("c:\windows\calc.exe")<br>
		shell.exec("cmd", "/c dir > out.txt")<br>
		<br>
		-- открыть каталог<br>
		shell.exec("c:\windows")<br>
		shell.exec("c:\windows", nil, false, "find")<br>
		shell.exec("c:\windows", nil, false, "explore")<br>
		<br>
		-- открыть ссылку на сайт<br>
		shell.exec("http://www.site.ru")<br>
		<br>
		-- послать E-mail<br>
		shell.exec("mailto:support@mail.ru")<br>
		<br>
		-- открыть файл<br>
		shell.exec("D:\file.doc")<br>
		<br>
		-- распечатать файл<br>
		shell.exec("D:\file.doc", nil, true, "print")<br>
		<br>
		-- редактировать файл<br>
		shell.exec("D:\shell_rus.html", nil, false, "edit")
		</div>
		</p>
	<p class="author">Авторы: Стив Донован, Маслов Дмитрий</p>
</td></tr>

<tr><td>
	<p class="head"> <sup>new</sup>
		<dfn>fileexists (strFileName)</dfn>
	</p>
	<p>
	<b>Описание:</b><br>
		&nbsp;&nbsp;Проверяет существует ли файл или папка с указанным именем.<br>
	<br>
	<b>Параметры:</b><br>
		&nbsp;&nbsp;<dfn>strFileName</dfn> - имя файла или папки<br>
		<br>
	<b>Возвращаемое значение:</b><br>
		&nbsp;&nbsp;Возвращает <var>true</var> или <var>false</var><br>
	</p>
		<p><b>Пример использования:</b>
		<div class="example">
		if shell.fileexists("c:\tmp\test.log") then<br>
		&nbsp;&nbsp;print("Файл c:\tmp\test.log существует")<br>
		end
		</div>
		</p>
	<p class="author">Автор: VladVRO</p>
</td></tr>

<tr><td>
	<p class="head"> <sup>new</sup>
		<dfn>findfiles (strFindMask)</dfn>
	</p>
	<p>
	<b>Описание:</b><br>
		&nbsp;&nbsp;Ищет файлы и папки по маске и результат возвращает в виде таблицы.<br>
	<br>
	<b>Параметры:</b><br>
		&nbsp;&nbsp;<dfn>strFindMask</dfn> - имя файла или папки, или маска с использованием группового символа (wildcard), который заменяет один или несколько символов: знак вопроса (<var>?</var>) может представлять любой одиночный символ; звездочка (<var>*</var>) используется для представления любого символа или группы символов.<br>
		<br>
	<b>Возвращаемое значение:</b><br>
		&nbsp;&nbsp;Возвращает список найденных файлов и папок в виде нумерованной таблицы (нумерация начиается с <var>1</var>),<br>
		&nbsp;&nbsp;где каждый элемент - структура содержащая:<br>
		<table style="margin-left:8pt;margin-top:3pt;margin-bottom:3pt">
		<tr><th>Значение</th><th>Описание</th></tr>
		<tr>
			<td align="left">name</td>
			<td>имя папки или файла</td>
		</tr>
		<tr>
			<td align="left">isdirectory</td>
			<td>признак файл это или папка (<var>true</var> если папка, <var>false</var> если файл)</td>
		</tr>
		<tr>
			<td align="left">attributes</td>
			<td>атрибуты файла (см. ниже)</td>
		</tr>
		<tr>
			<td align="left">size</td>
			<td>размер файла в байтах</td>
		</tr>
		</table>
		&nbsp;&nbsp;где атрибуты файла представлены в виде числа, которое может быть комбинацией следующих значений:<br>
		<table style="margin-left:8pt;margin-top:3pt;margin-right:8pt">
		<tr><th>Значение</th><th>Описание</th></tr>
		<tr>
			<td>0x00000001</td>
			<td>Файл только для чтения. Приложения могут читать такой файл, но не могут записывать или удалять его.</td>
		</tr>
		<tr>
			<td>0x00000002</td>
			<td>Файл скрыт. Такой файл не включается в обычный листинг каталога.</td>
		</tr>
		<tr>
			<td>0x00000004</td>
			<td>Это системный файл. Обычно такой файл является частью операционной системы.</td>
		</tr>
		<tr>
			<td>0x00000010</td>
			<td>Это каталог.</td>
		</tr>
		<tr>
			<td>0x00000020</td>
			<td>Это архивный файл. Приложения должны использовать этот флаг для копирования, архивирования или удаления.</td>
		</tr>
		<tr>
			<td>0x00000080</td>
			<td>У этого файла не установлены другие атрибуты. Это значение корректно только при использовании без остальных флагов.</td>
		</tr>
		<tr>
			<td>0x00000100</td>
			<td>Это временный файл. Приложения должны записывать в такой файл только в крайней необходимости. Большая часть данных файла находится в памяти и не сбрасывается наак как файл будет удален.</td>
		</tr>
		<tr>
			<td>0x00000200</td>
			<td>Файл является т.н. "Sparse file".</td>
		</tr>
		<tr>
			<td>0x00000400</td>
			<td>Каталог является символической связью.</td>
		</tr>
		<tr>
			<td>0x00000800</td>
			<td>Файл или каталог сжат. Для файла это означает, что все данные его сжаты, для каталога - что компрессия по умолчанию применяется ко всем его файлам и подкаталогам.</td>
		</tr>
		<tr>
			<td>0x00001000</td>
			<td>Данные файла не доступны непосредственно. Означает, что реальные данные файла были физически перемещены на устройства хранения.</td>
		</tr>
		<tr>
			<td>0x00002000</td>
			<td>Этот файл или каталог не будут индексироваться службой индексирования.</td>
		</tr>
		<tr>
			<td>0x00004000</td>
			<td>Файл или каталог зашифрован. Для файла, это означает, что все данные в файле зашифрованы. Для директория, это означает, что шифрование является умолчанием дляозданных файлов и подкаталогов.</td>
		</tr>
		<tr>
			<td>0x00010000</td>
			<td>Этот файл - виртуальный файл.</td>
		</tr>
		</table>
		<br>
		&nbsp;&nbsp;В случае неудачи возвращает <var>nil</var>
	</p>
		<p><b>Пример использования:</b>
		<div class="example">
		local t = shell.findfiles("*")<br>
		if t then<br>
		&nbsp;&nbsp;table.sort(t,<br>
		&nbsp;&nbsp;&nbsp;&nbsp;function(v1,v2)<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if v1.isdirectory ~= v2.isdirectory then<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return v1.isdirectory<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return v1.name &lt; v2.name<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<br>
		&nbsp;&nbsp;&nbsp;&nbsp;end<br>
		&nbsp;&nbsp;)<br>
		&nbsp;&nbsp;table.foreachi(t,<br>
		&nbsp;&nbsp;&nbsp;&nbsp;function(i,v)<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if v.isdirectory then<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print('D', v.attributes, v.name)<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(' ', v.attributes, v.name, v.size)<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<br>
		&nbsp;&nbsp;&nbsp;&nbsp;end<br>
		&nbsp;&nbsp;)<br>
		else<br>
		&nbsp;&nbsp;print('not found')<br>
		end
		</div>
		</p>
	<p class="author">Автор: VladVRO</p>
</td></tr>

</table>

<h3>Загрузка</h3>

<p><u>Текущая версия Shell</u>: <var>1.1</var><br></p>
<p>
<a href="http://scite-ru.googlecode.com/svn/trunk/pack/tools/LuaLib/shell.dll">shell.dll</a><br>
<a href="http://scite-ru.googlecode.com/svn/trunk/shell/">Исходный код</a>
</p>

</body>
</html>
